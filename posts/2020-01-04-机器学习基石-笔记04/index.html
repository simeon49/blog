<!DOCTYPE html>
<html lang="zh-Hans-CN">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<meta name="author" content="Simeon">
		<meta name="description" content="Simeon 个人微博">
		<meta name="generator" content="Hugo 0.52" />
		<title>机器学习基石-笔记04 &middot; Simeon&#39;s blog</title>
		<link rel="shortcut icon" href="https://simeon49.github.io/blog/images/favicon.ico">
		<link rel="stylesheet" href="https://simeon49.github.io/blog/css/style.css">
		<link rel="stylesheet" href="https://simeon49.github.io/blog/css/highlight.css">

		
		<link rel="stylesheet" href="https://simeon49.github.io/blog/css/font-awesome.min.css">
		

		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://simeon49.github.io/blog/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://simeon49.github.io/blog/posts'>Archive</a>
	<a href='https://simeon49.github.io/blog/tags'>Tags</a>
	<a href='https://simeon49.github.io/blog/categories'>Categories</a>
	<a href='https://simeon49.github.io/blog/about'>About</a>

	

	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        机器学习基石-笔记04
                    </h1>
                    <h2 class="headline">
                    Jan 4, 2020 00:00
                    · 3146 words
                    · 7 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://simeon49.github.io/blog/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">机器学习</a>
                          
                              <a href="https://simeon49.github.io/blog/tags/ml">ML</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    

<p>NTU林轩田的《机器学习基石》课程笔记(转载) <br>
&hellip;</p>

<h1 id="4-feasibility-of-learning">4 &ndash; Feasibility of Learning</h1>

<p>上节课，我们主要介绍了根据不同的设定，机器学习可以分为不同的类型。其中，监督式学习中的二元分类和回归分析是最常见的也是最重要的机器学习问题。本节课，我们将介绍机器学习的可行性，讨论问题是否可以使用机器学习来解决。</p>

<h3 id="一-learning-is-impossible"><strong>一、Learning is Impossible</strong></h3>

<p>首先，考虑这样一个例子，如下图所示，有3个label为-1的九宫格和3个label为+1的九宫格。根据这6个样本，提取相应label下的特征，预测右边九宫格是属于-1还是+1？结果是，如果依据对称性，我们会把它归为+1；如果依据九宫格左上角是否是黑色，我们会把它归为-1。除此之外，还有根据其它不同特征进行分类，得到不同结果的情况。而且，这些分类结果貌似都是正确合理的，因为对于6个训练样本来说，我们选择的模型都有很好的分类效果。</p>

<p><img src="../../pic/ML/c4912fc4b106a71eb0a6bbaab4bfe73f.jpg" alt="这里写图片描述" /></p>

<p>再来看一个比较数学化的二分类例子，输入特征x是二进制的、三维的，对应有8种输入，其中训练样本D有5个。那么，根据训练样本对应的输出y，假设有8个hypothesis，这8个hypothesis在D上，对5个训练样本的分类效果效果都完全正确。但是在另外3个测试数据上，不同的hypothesis表现有好有坏。在已知数据D上，<img src="../../pic/ML/777c1c6806abe7e3635c0e5443932447.jpg" alt="" />；但是在D以外的未知数据上，<img src="../../pic/ML/777c1c6806abe7e3635c0e5443932447.jpg" alt="" />不一定成立。而机器学习目的，恰恰是希望我们选择的模型能在未知数据上的预测与真实结果是一致的，而不是在已知的数据集D上寻求最佳效果。</p>

<p><img src="../../pic/ML/8cb724d6c8907309ce8e3c668babf164.jpg" alt="这里写图片描述" /></p>

<p>这个例子告诉我们，我们想要在D以外的数据中更接近目标函数似乎是做不到的，只能保证对D有很好的分类结果。机器学习的这种特性被称为没有免费午餐（No Free Lunch）定理。NFL定理表明没有一个学习算法可以在任何领域总是产生最准确的学习器。不管采用何种学习算法，至少存在一个目标函数，能够使得随机猜测算法是更好的算法。平常所说的一个学习算法比另一个算法更“优越”，效果更好，只是针对特定的问题，特定的先验信息，数据的分布，训练样本的数目，代价或奖励函数等。从这个例子来看，NFL说明了无法保证一个机器学习算法在D以外的数据集上一定能分类或预测正确，除非加上一些假设条件，我们以后会介绍。</p>

<h3 id="二-probability-to-the-rescue"><strong>二、Probability to the Rescue</strong></h3>

<p>从上一节得出的结论是：在训练集D以外的样本上，机器学习的模型是很难，似乎做不到正确预测或分类的。那是否有一些工具或者方法能够对未知的目标函数f做一些推论，让我们的机器学习模型能够变得有用呢？</p>

<p>如果有一个装有很多（数量很大数不过来）橙色球和绿色球的罐子，我们能不能推断橙色球的比例u？统计学上的做法是，从罐子中随机取出N个球，作为样本，计算这N个球中橙色球的比例v，那么就估计出罐子中橙色球的比例约为v。</p>

<p><img src="../../pic/ML/15f9d2722823307c158559957d378254.jpg" alt="这里写图片描述" /></p>

<p>这种随机抽取的做法能否说明罐子里橙色球的比例一定是v呢？答案是否定的。但是从概率的角度来说，样本中的v很有可能接近我们未知的u。下面从数学推导的角度来看v与u是否相近。</p>

<p>已知u是罐子里橙色球的比例，v是N个抽取的样本中橙色球的比例。当N足够大的时候，v接近于u。这就是Hoeffding’s inequality：</p>

<p>Hoeffding不等式说明当N很大的时候，v与u相差不会很大，它们之间的差值被限定在<img src="../../pic/ML/3ceac491143c898df94d6ebb92cfa25f.jpg" alt="" />之内。我们把结论v=u称为probably approximately correct(PAC)。</p>

<p><img src="../../pic/ML/f64fab987011ed7db0989e5053384b39.jpg" alt="这里写图片描述" /></p>

<h3 id="三-connection-to-learning"><strong>三、Connection to Learning</strong></h3>

<p>下面，我们将罐子的内容对应到机器学习的概念上来。机器学习中hypothesis与目标函数相等的可能性，类比于罐子中橙色球的概率问题；罐子里的一颗颗弹珠类比于机器学习样本空间的x；橙色的弹珠类比于h(x)与f不相等；绿色的弹珠类比于h(x)与f相等；从罐子中抽取的N个球类比于机器学习的训练样本D，且这两种抽样的样本与总体样本之间都是独立同分布的。所以呢，如果样本N够大，且是独立同分布的，那么，从样本中<img src="../../pic/ML/014d5d4e87c2d86bbc8f5f93ab9f0ef7.jpg" alt="" />的概率就能推导在抽样样本外的所有样本中<img src="../../pic/ML/014d5d4e87c2d86bbc8f5f93ab9f0ef7.jpg" alt="" />的概率是多少。</p>

<p><img src="../../pic/ML/422a4a4e35abaca291d0594bbc78966a.jpg" alt="这里写图片描述" /></p>

<p>映射中最关键的点是讲抽样中橙球的概率理解为样本数据集D上h(x)错误的概率，以此推算出在所有数据上h(x)错误的概率，这也是机器学习能够工作的本质，即我们为啥在采样数据上得到了一个假设，就可以推到全局呢？因为两者的错误率是PAC的，只要我们保证前者小，后者也就小了。</p>

<p><img src="../../pic/ML/6ab071e96063c210af9dad03d7890ab2.jpg" alt="这里写图片描述" /></p>

<p>这里我们引入两个值<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />和<img src="../../pic/ML/fe9b1118427000a29a9f9e54d288c701.jpg" alt="" />。<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />表示在抽样样本中，h(x)与<img src="../../pic/ML/48d037eec62d870708acff75f000806d.jpg" alt="" />不相等的概率；<img src="../../pic/ML/fe9b1118427000a29a9f9e54d288c701.jpg" alt="" />表示实际所有样本中，h(x)与f(x)不相等的概率是多少。</p>

<p><img src="../../pic/ML/cbd827a026cbac360360200496b6ace4.jpg" alt="这里写图片描述" /></p>

<p>同样，它的Hoeffding’s inequality可以表示为：</p>

<p>该不等式表明，<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />也是PAC的。如果<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />，<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />很小，那么就能推断出<img src="../../pic/ML/fe9b1118427000a29a9f9e54d288c701.jpg" alt="" />很小，也就是说在该数据分布P下，h与f非常接近，机器学习的模型比较准确。</p>

<p>一般地，h如果是固定的，N很大的时候，<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />，但是并不意味着<img src="../../pic/ML/777c1c6806abe7e3635c0e5443932447.jpg" alt="" />。因为h是固定的，不能保证<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />足够小，即使<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />，也可能使<img src="../../pic/ML/fe9b1118427000a29a9f9e54d288c701.jpg" alt="" />偏大。所以，一般会通过演算法A，选择最好的h，使<img src="../../pic/ML/d7456181e4a1dc67ec0595e27aa6cb2a.jpg" alt="" />足够小，从而保证<img src="../../pic/ML/fe9b1118427000a29a9f9e54d288c701.jpg" alt="" />很小。固定的h，使用新数据进行测试，验证其错误率是多少。</p>

<p><img src="../../pic/ML/e1489a185d2f234739f2d60cd11f93db.jpg" alt="这里写图片描述" /></p>

<h3 id="四-connection-to-real-learning"><strong>四、Connection to Real Learning</strong></h3>

<p><img src="../../pic/ML/75f824b59ab187340120505c35679e38.jpg" alt="这里写图片描述" /></p>

<p>假设现在有很多罐子M个（即有M个hypothesis），如果其中某个罐子抽样的球全是绿色，那是不是应该选择这个罐子呢？我们先来看这样一个例子：150个人抛硬币，那么其中至少有一个人连续5次硬币都是正面朝上的概率是</p>

<p>可见这个概率是很大的，但是能否说明5次正面朝上的这个硬币具有代表性呢？答案是否定的！并不能说明该硬币单次正面朝上的概率很大，其实都是0.5。一样的道理，抽到全是绿色求的时候也不能一定说明那个罐子就全是绿色球。当罐子数目很多或者抛硬币的人数很多的时候，可能引发Bad Sample，Bad Sample就是<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />和<img src="../../pic/ML/02ff91b1115630455f0eaac83fd1a6f4.jpg" alt="" />差别很大，即选择过多带来的负面影响，选择过多会恶化不好的情形。</p>

<p>根据许多次抽样的到的不同的数据集D，Hoeffding’s inequality保证了大多数的D都是比较好的情形（即对于某个h，保证<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />），但是也有可能出现Bad Data，即<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />和<img src="../../pic/ML/02ff91b1115630455f0eaac83fd1a6f4.jpg" alt="" />差别很大的数据集D，这是小概率事件。</p>

<p><img src="../../pic/ML/975737cb37c1124aa9e8d5ff644ea1f3.jpg" alt="这里写图片描述" /></p>

<p>也就是说，不同的数据集<img src="../../pic/ML/7147db75452155b77c4f943044ef30c4.jpg" alt="" />，对于不同的hypothesis，有可能成为Bad Data。只要<img src="../../pic/ML/7147db75452155b77c4f943044ef30c4.jpg" alt="" />在某个hypothesis上是Bad Data，那么<img src="../../pic/ML/7147db75452155b77c4f943044ef30c4.jpg" alt="" />就是Bad Data。只有当<img src="../../pic/ML/7147db75452155b77c4f943044ef30c4.jpg" alt="" />在所有的hypothesis上都是好的数据，才说明<img src="../../pic/ML/7147db75452155b77c4f943044ef30c4.jpg" alt="" />不是Bad Data，可以自由选择演算法A进行建模。那么，根据Hoeffding’s inequality，Bad Data的上界可以表示为连级（union bound）的形式：</p>

<p><img src="../../pic/ML/3e987fcc8d8ee3395d800efa97d30a76.jpg" alt="这里写图片描述" /></p>

<p>其中，M是hypothesis的个数，N是样本D的数量，<img src="../../pic/ML/3ceac491143c898df94d6ebb92cfa25f.jpg" alt="" />是参数。该union bound表明，当M有限，且N足够大的时候，Bad Data出现的概率就更低了，即能保证D对于所有的h都有<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />，满足PAC，演算法A的选择不受限制。那么满足这种union bound的情况，我们就可以和之前一样，选取一个合理的演算法（PLA/pocket），选择使<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />最小的<img src="../../pic/ML/805c7ce97d4ef084bcbe43d0b12d7d0f.jpg" alt="" />作为矩g，一般能够保证<img src="../../pic/ML/777c1c6806abe7e3635c0e5443932447.jpg" alt="" />，即有不错的泛化能力。</p>

<p>所以，如果hypothesis的个数M是有限的，N足够大，那么通过演算法A任意选择一个矩g，都有<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />成立；同时，如果找到一个矩g，使<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />，PAC就能保证<img src="../../pic/ML/02ff91b1115630455f0eaac83fd1a6f4.jpg" alt="" />。至此，就证明了机器学习是可行的。</p>

<p><img src="../../pic/ML/ac553e6c89d844665df47903b119eab5.jpg" alt="这里写图片描述" /></p>

<p>但是，如上面的学习流程图右下角所示，如果M是无数个，例如之前介绍的PLA直线有无数条，是否这些推论就不成立了呢？是否机器就不能进行学习呢？这些内容和问题，我们下节课再介绍。</p>

<h3 id="五-总结"><strong>五、总结</strong></h3>

<p>本节课主要介绍了机器学习的可行性。首先引入NFL定理，说明机器学习无法找到一个矩g能够完全和目标函数f一样。接着介绍了可以采用一些统计上的假设，例如Hoeffding不等式，建立<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />和<img src="../../pic/ML/02ff91b1115630455f0eaac83fd1a6f4.jpg" alt="" />的联系，证明对于某个h，当N足够大的时候，<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />和<img src="../../pic/ML/02ff91b1115630455f0eaac83fd1a6f4.jpg" alt="" />是PAC的。最后，对于h个数很多的情况，只要有h个数M是有限的，且N足够大，就能保证<img src="../../pic/ML/c4d371480622b6ea2e62ad466017e7c9.jpg" alt="" />，证明机器学习是可行的。</p>

<p><strong><em>注明：</em></strong></p>

<p>文章中所有的图片均来自台湾大学林轩田《机器学习基石》课程。</p>

                </section>
            </article>

            

            
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'simeon49';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';

        
        var disquesLoaded = false;
        dsq.onload = function () {
            disquesLoaded = true;
        };
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

        setTimeout(() => {
            if (!disquesLoaded) {
                alert('加载disques 失败!');
            }
        }, 3000);

    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

            

            
                <ul id="post-list" class="archive readmore">
    <h3>Read more</h3>

    
    
    
        <li>
            <a href="/blog/posts/2020-01-09-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B009/">机器学习基石-笔记09<aside class="dates">Jan 9 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-08-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B008/">机器学习基石-笔记08<aside class="dates">Jan 8 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-07-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B007/">机器学习基石-笔记07<aside class="dates">Jan 7 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-06-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B006/">机器学习基石-笔记06<aside class="dates">Jan 6 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-05-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B005/">机器学习基石-笔记05<aside class="dates">Jan 5 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-03-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B003/">机器学习基石-笔记03<aside class="dates">Jan 3 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B002/">机器学习基石-笔记02<aside class="dates">Jan 2 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2020-01-01-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%9F%B3-%E7%AC%94%E8%AE%B001/">机器学习基石-笔记01<aside class="dates">Jan 1 2020</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2019-05-10-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E5%AE%B9%E5%A4%8D%E4%B9%A007-mysql%E7%9A%84%E8%A1%8C%E7%BA%A7%E9%94%81%E5%85%B1%E4%BA%AB%E9%94%81%E4%B8%8E%E6%8E%92%E5%AE%83%E9%94%81/">数据库内容复习07-MySql的行级锁共享锁与排它锁<aside class="dates">May 10 2019</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/2019-04-12-web-component/">web-component<aside class="dates">Apr 12 2019</aside></a>
        </li>
    
</ul>

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://github.com/simeon49">
        <i class="fa fa-github-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2020 <i class="fa fa-heart" aria-hidden="true"></i> Simeon
    
    </p>
    
</footer>

        </section>

        <script src="https://simeon49.github.io/blog/js/jquery-3.3.1.min.js"></script>
<script src="https://simeon49.github.io/blog/js/main.js"></script>
<script src="https://simeon49.github.io/blog/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>






<script>
var baiduAnalytics = '74fafdde017951e1df78c761e7c017bc';
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + baiduAnalytics;
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    </body>
</html>
